<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/mainframe.css">
    <link rel="stylesheet" href="css/animate.css">
    <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
    <script src="js/velocity.min.js"></script>
    <script src="js/global.js"></script>
</head>

<body>
    <div class="content">
        <header class="header-warp">
            <div class="header-left">
                <img src="image/logo.png" alt="网络空间安全靶场竞技系统(西普教育)" class="header-logo">
            </div>
            <div class="header-mid">
                <h1 class="header-title">大赛大赛名称大赛名称大赛名称大赛名称大赛名称大赛名称大赛名称</h1>
            </div>
            <ul class="header-right">
                <li>
                    <span class="header-time-font">距离比赛结束</span>
                    <span class="header-time">12时59分59秒</span>
                </li>
                <li>
                    <span class="header-time-font">距离本阶段结束</span>
                    <span class="header-time">12时59分59秒</span>
                </li>
            </ul>
        </header>
        <div class="main">
            <div class="main-left">
                <div class="main-name-logo">
                    <img src="image/first_name.png" alt="">
                </div>
                <div class="main-cont">
                    <div class="cont-title">
                        <span class="cont-title-name">阶段排行榜</span>
                    </div>
                    <div class="cont-th">
                        <div>
                            <span>总排名</span>
                            <span>队名</span>
                            <span>阶段得分</span>
                        </div>
                    </div>
                    <ul class="cont-content">
                        <li class="li-rank">
                            <div class="cont-rank">
                                <span></span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li class="li-rank">
                            <div class="cont-rank">
                                <span></span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li class="li-rank">
                            <div class="cont-rank">
                                <span></span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                    </ul>
                    <div class="cont-footer">
                        <div class="cont-footer-bg"></div>
                    </div>
                </div>
            </div>
            <div class="main-mid">
                <div class="mid-notice-cont">
                    <span>啊大家按时寄达时间到了家啊大家啊时啊大家按时寄达时间到了家啊大家啊时啊大家按时寄达时间到了家啊大家啊时间到了就打算来讲都是垃圾到拉萨按时间来得及撒赖可见度是垃圾啊大家按时寄</span>
                    <div class="mid-notice-mask"></div>
                </div>
                <div id="mainframe_action_block" class="mainframe_action_block">

                </div>
            </div>
            <div class="main-right">
                <div class="now-time">
                    <span class="now-time-font">01:26:34</span>
                </div>
                <div class="main-cont">
                    <div class="cont-title">
                        <span class="cont-title-name">阶段排行榜</span>
                    </div>
                    <div class="cont-th">
                        <div>
                            <span>总排名</span>
                            <span>队名</span>
                            <span>阶段得分</span>
                        </div>
                    </div>
                    <ul class="cont-content">
                        <li class="li-rank">
                            <div class="cont-rank">
                                <span></span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li class="li-rank">
                            <div class="cont-rank">
                                <span></span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li class="li-rank">
                            <div class="cont-rank">
                                <span></span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                        <li>
                            <div class="cont-rank">
                                <span>4</span>
                            </div>
                            <div class="cont-ground">
                                <img src="image/test.jpg" alt="">
                                <span>古之而来着</span>
                            </div>
                            <span class="cont-count">4题</span>
                        </li>
                    </ul>
                    <div class="cont-footer">
                        <div class="cont-footer-bg"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // var a = [];
        // a.length = 100;
        // a.join().split(',').map(function (value,index) {
        //     a[index] = index+1;
        //     return a
        // });
        // a.join().split(',').filter(function (value, index) {
        //     a[index] = index + 1;
        //     return a
        // })
        // console.log(a)



        $(function () {
            // var _team_json = [
            //     {
            //         group_id: 0001,
            //         group_name: '战队1',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 0002,
            //         group_name: '战队2',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 0003,
            //         group_name: '战队3',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 0004,
            //         group_name: '战队4',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 0005,
            //         group_name: '战队5',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 0006,
            //         group_name: '战队6',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 0007,
            //         group_name: '战队7',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 0008,
            //         group_name: '战队8',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 0009,
            //         group_name: '战队9',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     },
            //     {
            //         group_id: 00010,
            //         group_name: '战队10',
            //         group_icon: 'image/mainframe/34234.jpg'
            //     }
            // ];
            var _qusetion_json = [
                {
                    topic_id: 0001,
                    'levels': [
                        1, 2, 3, 4, 5 // 小题id
                    ]
                },
                {
                    topic_id: 0002,
                    'levels': [
                        1, 2, 3, 4, 5 // 小题id
                    ]
                }
            ];

            var MAINFRAME = {
                _options: {
                    _action_div_id: 'mainframe_action_block',
                    _action_team_ul_id: 'ul_mainframe_action_team_list',
                    _action_team_ul_class: 'ul_mainframe_action_team_list',
                    _action_team_block_id: 'mainframe_action_block_main',
                    _action_team_block_class: 'mainframe_action_block_main',
                    _team_icon_size: 40,
                    _team_num: 10
                },
                _array_team: [],
                _array_topic: [],
                _team_change_index: 0,
            };
            MAINFRAME.initTeam = function () {
                var _html = '<ul class="' + this._options._action_team_ul_class + '" id="' + this._options._action_team_ul_id + '">';;
                for (var _i = 0; _i < this._options._team_num; _i++) {
                    _html += '<li>' +
                        '<img src="" data-team-id="" />' +
                        '</li>';
                }
                _html += '</ul>';
                $('#' + MAINFRAME._options._action_div_id).append(_html);
            };
            MAINFRAME.initQuestion = function (data) {
                var _element = null,
                    _levels = null,
                    _html = '<ul class="' + this._options._action_team_block_class + '" id="' + this._options._action_team_block_id + '">';
                for (var _i = 0, _len = data.length; _i < _len; _i++) {
                    _html += '<li data-topic-id="' + data[_i]["topic_id"] + '">' +
                        '<span class="action_mainframe_action_block_main"></span>' +
                        '<div class="mainframe_action_block_question">';
                    _levels = data[_i]["levels"];
                    for (var _j = 0, _lenj = _levels.length; _j < _lenj; _j++) {
                        _element = _levels[_j];
                        _html += '<img src="image/mainframe/mainframe_action_block_question.png" data-qid=' + _element + ' />'
                    }
                    _html += '</div>';
                    _html += '</li>';
                }
                _html += '</ul>';
                $('#' + this._options._action_div_id).append(_html);
            };
            MAINFRAME.getTopicById = function (topic_id) {
                return $('#' + this._options._action_team_block_id).find("li[data-topic-id=" + topic_id + "]");
            };
            MAINFRAME.getLevelById = function (topic_id, level_id) {
                var target = this.getTopicById(topic_id);
                return target.find("img[data-qid=" + topic_id + "]");
            };
            MAINFRAME.teamAttack = function (data) {
                var _li = $('#' + this._options._action_team_ul_id + '>li:eq(' + this._team_change_index + ')'),
                    _html = data.group_name +
                        '<img src="' + data.group_icon + '" data-team-id="' + data.group_id + '" />',
                    _team_icon = _li.find("img"),
                    _level = this.getLevelById(data.topic_id, data.level_id),
                    _team_icon_pos_top = Math.round(_team_icon.offset().top - _team_icon.parent().parent().offset().top),
                    _team_icon_pos_left = Math.round(_team_icon.offset().left - _team_icon.parent().parent().offset().left),
                    _level_pos_top = Math.round(_level.position().top + _level.parent().parent().position().top + _level.parent().parent().parent().position().top),
                    _level_pos_left = Math.round(_level.position().left + _level.parent().parent().position().left + _level.parent().parent().parent().position().left),
                    _rotate = GLOBAL_FUNC_SIMPLEEDU.getRotate({ "x": _team_icon_pos_left, "y": _team_icon_pos_top }, { "x": _level_pos_left, "y": _level_pos_top });
                _li.html(_html).addClass('animated bounceIn');

                // _html = $("<div>");
                // _html.addClass("action_mainframe_attack_linghting_area").offset({ "top": _team_icon_pos_top, "left": _team_icon_pos_left }).width((_level_pos_left - _team_icon_pos_left) * 100 / 1920 + "vw").height(((Math.abs(_level_pos_top - _team_icon_pos_top) + this._options._team_icon_size * 2) / 10.8) + "vh");
                var _attack_linghting = $('<span>').addClass('action_mainframe_attack_linghting');
                _attack_linghting.offset({ "top": _team_icon_pos_top, "left": _team_icon_pos_left - this._options._team_icon_size });
                alert(Math.abs(_level_pos_top - _team_icon_pos_top) / 10.8);
                // this.getLevelById(data.topic_id, data.level_id).fadeOut();
                _attack_linghting.velocity("stop").velocity({
                    rotateZ: - _rotate
                }, {
                        duration: 0,
                        // transform-origin: left center
                    }).velocity({
                        width: "14vw"
                    }).velocity({
                        left: _level_pos_left / 19.2 + "vw",
                        top: _level_pos_top / 10.8 + "vh"
                    });

                // _html.append(_attack_linghting);
                $('#' + this._options._action_div_id).append(_attack_linghting);
                this._team_change_index++;
            };

            MAINFRAME.initTeam();
            MAINFRAME.initQuestion(_qusetion_json);

            var activity = {
                'group_id': 1, // 团队id
                'group_name': '赵信团队1', // 团队名称
                'group_icon': 'image/mainframe/34234.jpg', // 团队头像
                'topic_id': 1, // 被攻击的大题id
                'level_id': 1 // 被攻击的小题id
            };
            MAINFRAME.teamAttack(activity);
            activity = {
                'group_id': 2, // 团队id
                'group_name': '赵信团队2', // 团队名称
                'group_icon': 'image/mainframe/34234.jpg', // 团队头像
                'topic_id': 1, // 被攻击的大题id
                'level_id': 1 // 被攻击的小题id
            };
            MAINFRAME.teamAttack(activity);

            $('#ul_mainframe_action_team_list').delegate('img', 'click', function () {
                var _this = $(this);
                alert(Math.round(_this.offset().top - _this.parent().parent().offset().top));
            });
        });
    </script>
</body>

</html>